<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="{WL_URL_ARES}css/header.css" rel="stylesheet">
    <link href="{WL_URL_ARES}css/control.css" rel="stylesheet">
    <link href="{WL_URL_ARES}css/resume.css" rel="stylesheet">
    <link href="{WL_URL_ARES}css/reguser1.css" rel="stylesheet">
    <title>登录</title>

</head>
<body>
{php include wl_template('common/header');}
<div style="width:100%">
    <div class="resume_content">

        <div class="login_msg" style="top: 120px;">
            <div class="login_zj">

                <div class="title_zj " style="font-size: 16px">账户登录</div>

                <label class="general-input wrap" >
                    <input type="text" id="user_name" placeholder="请输入您的手机号码/用户名">
                </label>
                <div class="chec_tip"></div>
                <label class="general-input wrap psw" >
                    <input type="password" id="password" placeholder="请输入密码">
                </label>
                <div class="chec_tip"></div>

                <div class="wrap forget">
                    <label class="rember_pwd">
                        <input style="width: auto" id="rember_pwdbtn" type="checkbox" >
                        <div class="remberpwdbtn">
                            <svg class="icon">
                                <use xlink:href=""></use>
                            </svg>
                        </div>
                        记住密码
                    </label>
                    <a href="{php echo app_url('member/index/forget_password')}">忘记密码？</a></div>
                <span class="public_bigbtn bg1aa wrap" id="login">登录</span>
            </div>
            <div class="foot_btns">
                <div class="con">
                    <a class="icons"  href="http://localhost/addons/recruit/core/common/Connect2.1/example/oauth/index.php" target="_blank">
                        <svg class="icon" style="color: #ffffff">
                            <use xlink:href="#icon-qq"></use>
                        </svg>
                    </a>
                    <a href="" class="icons left weixin_icons">
                        <svg class="icon" style="color: #ffffff">
                            <use xlink:href="#icon-weixin"></use>
                        </svg>
                    </a>
                    <a class="icons left weibo_icons" href="{$code_url}" target="_blank">
                        <svg class="icon" style="color: #ffffff">
                            <use xlink:href="#icon-weibo"></use>
                        </svg>
                    </a>
                <span class="icons left baidu_icons" data-url="{$baidu_loginUrl}">
                    <svg class="icon" style="color: #ffffff">
                        <use xlink:href="#icon-baidu"></use>
                    </svg>
                </span>
                    <div class="register font_zj1">
                        还没有账号：<a href="{php echo app_url('member/index/register')}"><span class="color">立即注册</span>
                        <svg class="icon" aria-hidden="true" style="color: #ffffff;font-size: 15px">
                            <use xlink:href="#icon-youjiantou"></use>
                        </svg></a>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>



</body>
<script src="{WL_URL_ARES}js/jquery.js" rel="script"></script>
<script src="{WL_URL_ARES}js/iconfont.js" rel="script"></script>
<script src="{WL_URL_ARES}js/jquery.cookie.js" rel="script"></script>
<script src="{WL_URL_ARES}js/control.js" rel="script"></script>
<script>
    $(document).ready(function(){

        $(".general-input input").focus(function(){
            var _this=$(this);
            if(_this.closest(".general-input").css("borderColor")=="rgb(226, 61, 70)"){
                _this.closest(".general-input").nextAll(".chec_tip").html("");
            }
        });

        function login(){
            var username=$('#user_name').val();//用户名
            var password=$("#password").val();//密码
            if($.trim(username)==""){
                $("#user_name").closest(".general-input").css("border-color","#e23d46");
                $("#user_name").closest(".general-input").next().html(tipmsg("error","请输入用户名"));
                return false;
            };
            if(password.length<6){
                $("#password").closest(".general-input").css("border-color","#e23d46");
                $("#password").closest(".general-input").next().html(tipmsg("error","请输入6-15位密码"));
                return false;
            };
            $.ajax({
                url:"{php echo app_url('member/index/login_deal')}",
                type:"post",
                data:{
                    user_name:username,
                    password:password
                },
                success:function(data){
                    var data = JSON.parse(data);
                    if(data.status==1){
                        window.location.href=data.content;
                    }else if(data.status==4){
                        $("#user_name").closest(".general-input").css("border-color","#e23d46");
                        $("#user_name").closest(".general-input").next().html(tipmsg("error","账户不存在"));

                    }else if(data.status==2){
                        $("#password").closest(".general-input").css("border-color","#e23d46");
                        $("#password").closest(".general-input").next().html(tipmsg("error","账户和密码不匹配"));

                    }else{
                        hint("error",data.content);

                    }
                }
            })
        }

        $("#login").on("click",function(){
            savecookie();
            login()
        });


        $("#rember_pwdbtn").on("change",function(){
            if($(this).is(':checked')){
                $(this).next().find("use").attr("xlink:href","#icon-zhengque1")
            }else{
                $(this).next().find("use").attr("xlink:href","")
            }
        });

        document.onkeydown = function(e){
            var ev = document.all ? window.event : e;
            if(ev.keyCode==13) {
                login()
            }
        }


        console.log($.cookie())
        var COOKIE_NAME = 'user_name';
        var COOKIE_PWD = 'password';
        if($.cookie("rmbuser")== "true"){
            $("#rember_pwdbtn").attr("checked", true);
            $("#rember_pwdbtn").next().find("use").attr("xlink:href","#icon-zhengque1")
            $("#user_name").val($.cookie(COOKIE_NAME));
            $("#password").val($.cookie(COOKIE_PWD));
        }else{
            $("#rember_pwdbtn").attr("checked", false);
            $("#user_name").val("");
            $("#password").val("");
        }

        function savecookie(){
            if ($("#rember_pwdbtn").attr("checked")) {
                var user_name = $("#user_name").val();
                var password = $("#password").val();
                $.cookie("rmbuser", "true", { expires: 7 }); //存储一个带7天期限的cookie
                $.cookie("user_name", user_name, { expires: 7 });
                $.cookie("password", password, { expires: 7 });
            }
            else {
                $.cookie("rmbuser", "false", { expire: -1 });
                $.cookie("user_name", "", { expires: -1 });
                $.cookie("password", "", { expires: -1 });
            }
        }
    })
</script>
</html>